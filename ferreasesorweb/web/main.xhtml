<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./WEB-INF/templates/layout.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:ez="http://java.sun.com/jsf/composite/ezcomp"
                xmlns:f="http://java.sun.com/jsf/core">

    <ui:define name="title">
        Página de inicio
    </ui:define>

    <ui:define name="content">
        <h:form id="formEncuestaNull" rendered="#{preguntaBean.encuestaActiva == null}">
            <h:outputText value="No hay Encuesta activa"/>
        </h:form>
        <h:form id="formEncuesta" rendered="#{preguntaBean.encuestaActiva != null}">
            <p:fieldset legend="#{preguntaBean.encuestaActiva.nombre}"><br/><br/>
                <ui:repeat value="#{preguntaBean.preguntaList}" var="question">
                    <h:outputText value="#{question.pregunta}" style="font-size: 14px; font-weight: bold; margin-left:25px;"/><br/>

                    <p:fieldset style="width: 70%; margin-left:25px;" rendered="#{question.tipo == 1}">
                        <h:panelGrid columns="2" style="">
                            <p:outputLabel value="#{question.respuestaConfList[0]}: "/>
                            <p:inputTextarea id="opinionTextBox" rows="6" cols="85" counter="counter" maxlength="350" value="#{preguntaBean.respuestaTexto}"      
                                             counterTemplate="{0} caracteres restantes."  
                                             required="true" requiredMessage="Respuesta requerida"/><br/> 
                            <h:outputText id="counter" /><br/> 
                            <p:message for="opinionTextBox"/>
                            
                        </h:panelGrid>
                        <p:commandButton value="Guardar" title="Guardar" icon="ui-icon-disk" style="float:right"
                                             action="#{respuestaObtenidaController.create}"/>
                    </p:fieldset>

                    <p:fieldset style="width: 70%; margin-left:25px;" rendered="#{question.tipo == 2}">
                        <h:panelGrid columns="2">
                            <h:outputText value="#{question.respuestaConfList[0]}: "/>
                            <p:inputText id="respuesta" value="#{preguntaBean.respuestaTexto}" style="width: 60px;"/>
                        </h:panelGrid>
                    </p:fieldset>

                    <p:fieldset style="width: 70%; margin-left:25px;" rendered="#{question.tipo == 3}">
                        <h:panelGrid columns="2">
                            <h:outputLabel for="opciones" value="Opciones: "/>
                            <h:selectOneRadio id="opciones" value="#{preguntaBean.respuestaTexto}" layout="pageDirection">
                                <f:selectItems value="#{question.respuestaConfList}" var="option" 
                                               itemLabel="#{option.opcion}" itemValue="#{option.id}" /> <br/>
                            </h:selectOneRadio>
                        </h:panelGrid>
                    </p:fieldset>

                    <p:fieldset style="width: 70%; margin-left:25px;" rendered="#{question.tipo == 4}">
                        <h:panelGrid columns="2">
                            <h:outputText value="En una escala del 1 al 10, siendo 1 la más baja y 10 la más alta, ¿cómo lo califica?: "/>
                            <p:inputText id="ratingTextBox" value="#{preguntaBean.respuestaTexto}" style="width: 60px;">
                                <f:convertNumber integerOnly="true" maxIntegerDigits="2" />
                            </p:inputText>
                        </h:panelGrid>
                    </p:fieldset>

<!--                   <ez:textualQuestion preguntaBody="#{preguntaBean.preguntaTexto}"
                                        preguntaPrompt="#{preguntaBean.promptPreguntaTextual}"
                                        preguntaBean="#{preguntaBean}"
                                        rendered="#{question.tipo == 1}"/>

                    <ez:numericQuestion preguntaBody="#{preguntaBean.preguntaTexto}"
                                        preguntaPrompt="Opciones: "
                                        preguntaBean="#{preguntaBean}"
                                        rendered="#{question.tipo == 2}"/>

                    <ez:selectionQuestion preguntaBody="#{preguntaBean.preguntaTexto}"
                                          preguntaPrompt="#{preguntaBean.promptPreguntaTextual}"
                                          preguntaBean="#{preguntaBean}"
                                          rendered="#{question.tipo == 3}"/>

                    <ez:ratingQuestion preguntaBody="#{preguntaBean.preguntaTexto}"
                                       preguntaPrompt="#{preguntaBean.promptPreguntaTextual}" 
                                       preguntaBean="#{preguntaBean}"
                                       rendered="#{question.tipo == 4}"/>-->

                    <br/><br/>
                </ui:repeat>

            </p:fieldset>
        </h:form>
    </ui:define>

    <ui:define name="status">

        <ui:include src="./WEB-INF/templates/snippets/statusButton.xhtml" />


        <!--CODIGO ORIGINAL EN EL MAIN-->
        <!--        <h:outputStylesheet library="css" name="display.css"/>
                <h:outputScript library="js" name="handleMessage.js"/>
        
                <h:outputText value="Aqui va una alarma"/>
                <h:form id="form">
                    <p:fieldset>
                        <h:panelGrid id="principal">
        
                            <c:forEach begin="1" end="4" varStatus="status">
                                <h:panelGrid id="panel_11" styleClass="ui-widget display#{status.index}1" style="display: none;">
                                    <h:outputText id="out11" value="#{status.index}"/>
                                </h:panelGrid>
                                <h:panelGrid id="panel_12" styleClass="ui-widget display#{status.index}2" style="display: none;">
                                    <h:outputText id="out12" value="#{status.index}"/>
                                </h:panelGrid>
                                <h:panelGrid id="panel_13" styleClass="ui-widget display#{status.index}3" style="display: none;">
                                    <h:outputText id="out13" value="#{status.index}"/>
                                </h:panelGrid>
                            </c:forEach>
                        </h:panelGrid>
                    </p:fieldset>
                </h:form>  
        
                <ui:repeat value="#{alarmaBean.botones}" var="boton" varStatus="status">
                    <p:socket onMessage="handleMessage#{status.index+1}" channel="/channel#{boton.id}"/>
                </ui:repeat>-->

    </ui:define>

</ui:composition>
